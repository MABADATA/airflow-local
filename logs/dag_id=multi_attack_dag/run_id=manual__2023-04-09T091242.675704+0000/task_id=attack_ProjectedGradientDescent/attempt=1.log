[2023-04-09 09:13:02,941] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: multi_attack_dag.attack_ProjectedGradientDescent manual__2023-04-09T09:12:42.675704+00:00 [queued]>
[2023-04-09 09:13:02,967] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: multi_attack_dag.attack_ProjectedGradientDescent manual__2023-04-09T09:12:42.675704+00:00 [queued]>
[2023-04-09 09:13:02,968] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2023-04-09 09:13:02,969] {taskinstance.py:1357} INFO - Starting attempt 1 of 2
[2023-04-09 09:13:02,970] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2023-04-09 09:13:02,998] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): attack_ProjectedGradientDescent> on 2023-04-09 09:12:42.675704+00:00
[2023-04-09 09:13:03,007] {standard_task_runner.py:52} INFO - Started process 6440 to run task
[2023-04-09 09:13:03,015] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'multi_attack_dag', 'attack_ProjectedGradientDescent', 'manual__2023-04-09T09:12:42.675704+00:00', '--job-id', '4893', '--raw', '--subdir', 'DAGS_FOLDER/attack_dag.py', '--cfg-path', '/tmp/tmpubuz35mp', '--error-file', '/tmp/tmpd43icpig']
[2023-04-09 09:13:03,017] {standard_task_runner.py:80} INFO - Job 4893: Subtask attack_ProjectedGradientDescent
[2023-04-09 09:13:03,123] {task_command.py:369} INFO - Running <TaskInstance: multi_attack_dag.attack_ProjectedGradientDescent manual__2023-04-09T09:12:42.675704+00:00 [running]> on host ff3d40af78f9
[2023-04-09 09:13:03,247] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=multi_attack_dag
AIRFLOW_CTX_TASK_ID=attack_ProjectedGradientDescent
AIRFLOW_CTX_EXECUTION_DATE=2023-04-09T09:12:42.675704+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-04-09T09:12:42.675704+00:00
[2023-04-09 09:13:03,251] {transport.py:157} INFO - Attempting refresh to obtain initial access_token
[2023-04-09 09:13:03,255] {client.py:777} INFO - Refreshing access_token
[2023-04-09 09:13:04,019] {transport.py:157} INFO - Attempting refresh to obtain initial access_token
[2023-04-09 09:13:04,021] {client.py:777} INFO - Refreshing access_token
[2023-04-09 09:13:05,315] {transport.py:157} INFO - Attempting refresh to obtain initial access_token
[2023-04-09 09:13:05,320] {client.py:777} INFO - Refreshing access_token
[2023-04-09 09:13:05,995] {pytorch.py:1198} INFO - Inferred 5 hidden layers on PyTorch classifier.
[2023-04-09 09:13:06,014] {transport.py:157} INFO - Attempting refresh to obtain initial access_token
[2023-04-09 09:13:06,017] {client.py:777} INFO - Refreshing access_token
[2023-04-09 09:14:14,779] {projected_gradient_descent.py:199} INFO - Creating adversarial samples.
[2023-04-09 09:14:15,124] {logging_mixin.py:115} WARNING - PGD - Batches:   0%|          | 0/32 [00:00<?, ?it/s]
[2023-04-09 09:14:15,820] {logging_mixin.py:115} WARNING - PGD - Batches:   3%|3         | 1/32 [00:00<00:21,  1.44it/s]
[2023-04-09 09:14:17,308] {logging_mixin.py:115} WARNING - PGD - Batches:   6%|6         | 2/32 [00:02<00:34,  1.16s/it]
[2023-04-09 09:14:24,733] {logging_mixin.py:115} WARNING - PGD - Batches:   9%|9         | 3/32 [00:09<01:56,  4.02s/it]
[2023-04-09 09:14:25,789] {logging_mixin.py:115} WARNING - PGD - Batches:  12%|#2        | 4/32 [00:10<01:19,  2.85s/it]
[2023-04-09 09:14:26,878] {logging_mixin.py:115} WARNING - PGD - Batches:  16%|#5        | 5/32 [00:11<00:59,  2.22s/it]
[2023-04-09 09:14:28,095] {logging_mixin.py:115} WARNING - PGD - Batches:  19%|#8        | 6/32 [00:12<00:48,  1.88s/it]
[2023-04-09 09:14:28,926] {logging_mixin.py:115} WARNING - PGD - Batches:  22%|##1       | 7/32 [00:13<00:38,  1.53s/it]
[2023-04-09 09:14:30,135] {logging_mixin.py:115} WARNING - PGD - Batches:  25%|##5       | 8/32 [00:15<00:34,  1.43s/it]
[2023-04-09 09:14:31,827] {logging_mixin.py:115} WARNING - PGD - Batches:  28%|##8       | 9/32 [00:16<00:34,  1.51s/it]
[2023-04-09 09:14:32,548] {logging_mixin.py:115} WARNING - PGD - Batches:  31%|###1      | 10/32 [00:17<00:27,  1.27s/it]
[2023-04-09 09:14:37,217] {logging_mixin.py:115} WARNING - PGD - Batches:  34%|###4      | 11/32 [00:22<00:48,  2.31s/it]
[2023-04-09 09:14:39,836] {logging_mixin.py:115} WARNING - PGD - Batches:  38%|###7      | 12/32 [00:24<00:48,  2.40s/it]
[2023-04-09 09:14:42,069] {logging_mixin.py:115} WARNING - PGD - Batches:  41%|####      | 13/32 [00:26<00:44,  2.35s/it]
[2023-04-09 09:14:43,832] {logging_mixin.py:115} WARNING - PGD - Batches:  44%|####3     | 14/32 [00:28<00:39,  2.17s/it]
[2023-04-09 09:14:45,252] {logging_mixin.py:115} WARNING - PGD - Batches:  47%|####6     | 15/32 [00:30<00:33,  1.95s/it]
[2023-04-09 09:14:47,006] {logging_mixin.py:115} WARNING - PGD - Batches:  50%|#####     | 16/32 [00:31<00:30,  1.89s/it]
[2023-04-09 09:14:49,654] {logging_mixin.py:115} WARNING - PGD - Batches:  53%|#####3    | 17/32 [00:34<00:31,  2.12s/it]
[2023-04-09 09:14:51,353] {logging_mixin.py:115} WARNING - PGD - Batches:  56%|#####6    | 18/32 [00:36<00:27,  1.99s/it]
[2023-04-09 09:14:53,950] {logging_mixin.py:115} WARNING - PGD - Batches:  59%|#####9    | 19/32 [00:38<00:28,  2.17s/it]
[2023-04-09 09:14:55,644] {logging_mixin.py:115} WARNING - PGD - Batches:  62%|######2   | 20/32 [00:40<00:24,  2.03s/it]
[2023-04-09 09:14:56,433] {logging_mixin.py:115} WARNING - PGD - Batches:  66%|######5   | 21/32 [00:41<00:18,  1.66s/it]
[2023-04-09 09:14:57,992] {logging_mixin.py:115} WARNING - PGD - Batches:  69%|######8   | 22/32 [00:42<00:16,  1.63s/it]
[2023-04-09 09:14:58,865] {logging_mixin.py:115} WARNING - PGD - Batches:  72%|#######1  | 23/32 [00:43<00:12,  1.40s/it]
[2023-04-09 09:15:00,875] {logging_mixin.py:115} WARNING - PGD - Batches:  75%|#######5  | 24/32 [00:45<00:12,  1.58s/it]
[2023-04-09 09:15:03,074] {logging_mixin.py:115} WARNING - PGD - Batches:  78%|#######8  | 25/32 [00:47<00:12,  1.77s/it]
[2023-04-09 09:15:04,600] {logging_mixin.py:115} WARNING - PGD - Batches:  81%|########1 | 26/32 [00:49<00:10,  1.70s/it]
[2023-04-09 09:15:04,804] {logging_mixin.py:115} WARNING - PGD - Batches:  84%|########4 | 27/32 [00:49<00:06,  1.25s/it]
[2023-04-09 09:15:04,983] {logging_mixin.py:115} WARNING - PGD - Batches:  88%|########7 | 28/32 [00:49<00:03,  1.08it/s]
[2023-04-09 09:15:05,496] {logging_mixin.py:115} WARNING - PGD - Batches:  91%|######### | 29/32 [00:50<00:02,  1.25it/s]
[2023-04-09 09:15:06,054] {logging_mixin.py:115} WARNING - PGD - Batches:  94%|#########3| 30/32 [00:50<00:01,  1.37it/s]
[2023-04-09 09:15:06,731] {logging_mixin.py:115} WARNING - PGD - Batches:  97%|#########6| 31/32 [00:51<00:00,  1.40it/s]
[2023-04-09 09:15:07,119] {logging_mixin.py:115} WARNING - PGD - Batches: 100%|##########| 32/32 [00:51<00:00,  1.62it/s]
[2023-04-09 09:15:07,125] {logging_mixin.py:115} WARNING -                                                               
[2023-04-09 09:15:07,209] {projected_gradient_descent_pytorch.py:239} INFO - Success rate of attack: 15.10%
[2023-04-09 09:15:07,247] {transport.py:157} INFO - Attempting refresh to obtain initial access_token
[2023-04-09 09:15:07,252] {client.py:777} INFO - Refreshing access_token
[2023-04-09 09:15:07,928] {xcom.py:585} ERROR - Could not serialize the XCom value into JSON. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your *** config.
[2023-04-09 09:15:07,930] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/attack_dag.py", line 131, in attack_ProjectedGradientDescent
    ti.xcom_push(key='attack_ProjectedGradientDescent_adv', value=adversarial_examples)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 71, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 2380, in xcom_push
    session=session,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 68, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 197, in set
    map_index=map_index,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 582, in serialize_value
    return json.dumps(value).encode('UTF-8')
  File "/usr/local/lib/python3.7/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.7/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.7/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.7/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type ndarray is not JSON serializable
[2023-04-09 09:15:07,954] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=multi_attack_dag, task_id=attack_ProjectedGradientDescent, execution_date=20230409T091242, start_date=20230409T091302, end_date=20230409T091507
[2023-04-09 09:15:07,979] {standard_task_runner.py:97} ERROR - Failed to execute job 4893 for task attack_ProjectedGradientDescent (Object of type ndarray is not JSON serializable; 6440)
[2023-04-09 09:15:08,066] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-04-09 09:15:08,141] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
